<section x-data="{ 
    pageLang: {},
    homePageLang: {},
    async init() {

    breadCrumbs = getBreadCrumbsArray();
    
    const lang = localStorage.getItem('appLang') || 'en';
    const fileName = breadCrumbs[breadCrumbs.length - 1].path.substring(2, breadCrumbs[breadCrumbs.length - 1].length);
    const response = await fetch('/lang/' + fileName + '/' + lang + '.json');
    this.pageLang = await response.json();
    this.homePageLang = await fetch('/lang/home/' + lang + '.json').then(response => response.json());
    document.title = breadCrumbs[breadCrumbs.length - 1].name || 'Portfolio';

    }
 }" x-init="init()" class="py-5">
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <div class="container mb-4">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="container w-100 d-flex justify-content-center flex-column">
                    <div class="d-flex align-items-center justify-content-center pb-2">
                        <!-- Haupt-Titel -->
                        <h1 class="text-center me-2" x-text="pageLang.header"></h1>
                    </div>
                    <template x-for="desc in pageLang.description">
                        <p x-html="desc"></p>
                    </template>
                </div>
            </div>
        </div>
    </div>
    <div class="container mb-4">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="container w-100 d-flex justify-content-center flex-column">
                    <div class="d-flex align-items-center justify-content-center pb-2">

                        <span class="mt-3 me-3 d-flex">
                            <a class="btn text-center ms-2" href="https://gitlab.com/andiblup" target="_blank"
                                data-tooltip="Gitlab" data-tooltip-position="bottom">
                                <i class="bi bi-grad bi-gitlab"></i>
                            </a>
                            <a class="btn text-center ms-2" href="https://github.com/andiblup" target="_blank"
                                data-tooltip="Github" data-tooltip-position="bottom">
                                <i class="bi bi-grad bi-github"></i>
                            </a>
                        </span>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="container mb-5">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="card shadow border" style="border-radius: 25px;">
                    <div class="card-body d-flex flex-column" x-data="{ showFeatures: true }">
                        <div class="d-flex align-items-center justify-content-between">
                            <h2 class="card-title mb-0" x-text="pageLang.features_title"></h2>
                            <i class="bi bi-grad cursor-pointer ms-2"
                                :class="{'bi-chevron-up': showFeatures, 'bi-chevron-down': !showFeatures}"
                                @click="showFeatures = !showFeatures"></i>
                        </div>

                        <div x-show="showFeatures" class="ps-0">
                            <hr>

                            <div class="contact-container" x-data="{
        success: false,
        error: false,

        async init() {
          emailjs.init('t5UW8Ux7a97B73XRT'); // Dein EmailJS Public Key
        },

        async sendMessage(event) {
          event.preventDefault();

          const recaptchaToken = grecaptcha.getResponse();
          if (!recaptchaToken) {
            alert('Bitte bestÃ¤tigen Sie das reCAPTCHA.');
            return;
          }

          try {
            await emailjs.sendForm(
              'service_ej8oi9n',     // Dein Service ID
              'template_0dtap7s',    // Dein Template ID
              this.$refs.form
            );
            this.success = true;
            this.error = false;
            this.$refs.form.reset();
            grecaptcha.reset();
          } catch (err) {
            console.error(err);
            this.success = false;
            this.error = true;
          }
        }
     }" x-init="init()">

                                <h2>Kontakt</h2>
                                <form x-ref="form" @submit="sendMessage">
                                    <div class="form-group">
                                        <label for="name">Name*</label>
                                        <input type="text" id="name" name="name" required />
                                    </div>
                                    <div class="form-group">
                                        <label for="email">E-Mail*</label>
                                        <input type="email" id="email" name="email" required />
                                    </div>
                                    <div class="form-group">
                                        <label for="message">Nachricht*</label>
                                        <textarea id="message" name="message" rows="5" required></textarea>
                                    </div>

                                    <div class="g-recaptcha my-3"
                                        data-sitekey="6Ld-eEIrAAAAAKgFKGe6nuZUwN2b0XeZh9mJirWP"></div>

                                    <button type="submit">Absenden</button>

                                    <div class="success-message" x-show="success">Vielen Dank! Nachricht gesendet.</div>
                                    <div class="error-message" x-show="error">Fehler beim Senden. Bitte versuchen Sie es
                                        erneut.</div>
                                </form>
                            </div>


                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



</section>